<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Leptos Components witnessing events - Building Apps with Rust</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Preface</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Acknowledgements</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> About this Book</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> About the Author</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> If you get stuck or lose steam</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Introductions</li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Programming</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> What it is</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> Why it's worth it</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.3.</strong> Why it's hard</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.4.</strong> Programmer Thinking</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Languages</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> Meaning and Interpretation</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Architectures</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> How your computer works</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> How the web works</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.3.</strong> The frontend-backend divide</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Tools and Languages</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">9.1.</strong> Bash and the terminal</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.2.</strong> Rust</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.3.</strong> Trunk</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.4.</strong> Web browsers</div></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Hello World</li><li class="chapter-item expanded "><a href="setup_intro.html"><strong aria-hidden="true">10.</strong> Setup</a></li><li class="chapter-item expanded "><a href="html_intro.html"><strong aria-hidden="true">11.</strong> Intro to HTML</a></li><li class="chapter-item expanded "><a href="view_macro_html.html"><strong aria-hidden="true">12.</strong> HTML and the view! macro</a></li><li class="chapter-item expanded affix "><li class="part-title">Leptos Components</li><li class="chapter-item expanded "><a href="leptos_component_intro.html"><strong aria-hidden="true">13.</strong> Intro to Leptos Components</a></li><li class="chapter-item expanded "><a href="view_macro_variables.html"><strong aria-hidden="true">14.</strong> Variables and the view! macro</a></li><li class="chapter-item expanded "><a href="leptos_component_properties.html"><strong aria-hidden="true">15.</strong> Leptos Component properties</a></li><li class="chapter-item expanded "><a href="leptos_component_dynamic_content_separation.html"><strong aria-hidden="true">16.</strong> Leptos Component dynamic content separation</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.</strong> Client Side</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">17.1.</strong> Events</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="leptos_component_logging_events.html" class="active"><strong aria-hidden="true">17.1.1.</strong> Leptos Components witnessing events</a></li><li class="chapter-item expanded "><a href="leptos_component_update_from_event.html"><strong aria-hidden="true">17.1.2.</strong> Leptos Components reacting to events</a></li><li class="chapter-item expanded "><a href="event_bubbling_and_signal_generics.html"><strong aria-hidden="true">17.1.3.</strong> Event Bubbling and Signal Generics</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.1.4.</strong> Preventing bubbling and default event behaviours </div></li><li class="chapter-item expanded "><a href="custom_events.html"><strong aria-hidden="true">17.1.5.</strong> Custom Events</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.1.6.</strong> Custom Event Data</div></li></ol></li><li class="chapter-item expanded "><a href="forms.html"><strong aria-hidden="true">17.2.</strong> Forms</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Building an Application</li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Design Patterns and Application Structure</li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Common Problems</li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Building Apps with Rust</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="leptos-components-and-logging-events"><a class="header" href="#leptos-components-and-logging-events">Leptos components and logging events</a></h1>
<h2 id="what-we-know"><a class="header" href="#what-we-know">What we know</a></h2>
<ul>
<li>Leptos makes distinctions between which things are static (will not change) and which are dynamic (can change)</li>
</ul>
<h2 id="what-well-learn"><a class="header" href="#what-well-learn">What we'll learn</a></h2>
<ul>
<li>How we can make our application dynamic through client side events</li>
</ul>
<h2 id="the-lesson"><a class="header" href="#the-lesson">The Lesson</a></h2>
<p>We've worked with static templates so far but it would be great if we can start to interact with our application. It would be wonderful if we could do something and see that change happen before our very eyes. </p>
<p>The secret to achieving this is in the &quot;if we could do something,&quot; part of what I just wrote.</p>
<p>When something happens in the browser—a key is pressed, a button is clicked, the mouse is moved—an event is fired. A piece of functionality gets called as part of the browser's JavaScript runtime declaring what happened along with some information about that event. </p>
<p>If we were writing these applications in JavaScript, the native language of the web's interactive runtime, we could declare a function as a callback (will be called when) an event happens, reacting to the interaction. Unfortunately, we can't directly do that because we're writing Rust which becomes WASM. But never fear, we have some pretty great tools to help us around this shortcoming.</p>
<p>Leptos comes bundled with a crate called <code>wasm-bindgen</code>. WASM bindgen which acts as an interface, allowing Rust to call JavaScript features and vise-versa. There are some crates that add extra helper fuctionality on top of that like <code>web_sys</code> which provides types and wrappers to interact with web and browser APIs.</p>
<p>Let's refresh our memory and look at our lucky number Leptos component:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[component]  
fn LuckyNumber(cx: Scope, the_lucky_number: i32) -&gt; Element {  
    view!{  
        cx,  
        &lt;div&gt;  
            &lt;p&gt;&quot;Today's lucky number is &quot; {the_lucky_number}&lt;/p&gt;  
        &lt;/div&gt;  
    }  
}
<span class="boring">}</span></code></pre></pre>
<p>Let's add a button to this which will eventually print a message in the client's web browser console (abbreviated for clarity).</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>	&lt;div&gt;  
		&lt;p&gt;&quot;Today's lucky number is &quot; {the_lucky_number}&lt;/p&gt;  
		&lt;button&gt;&quot;Your Secret Lucky Number&quot;&lt;/button&gt;  
	&lt;/div&gt;  
<span class="boring">}</span></code></pre></pre>
<p>Leptos makes it really easy to add event handlers—functionality triggered by events. We simply write 'on:' followed by the name of the event, and the name of the handler. </p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>&lt;button&gt;&quot;Your Secret Lucky Number&quot;&lt;/button&gt;  
<span class="boring">}</span></code></pre></pre>
<p>... is made interactive as follows...</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>&lt;button on:click=whisper_in_the_console &gt;&quot;Your Secret Lucky Number&quot;&lt;/button&gt;  
<span class="boring">}</span></code></pre></pre>
<p>But this is incomplete. We've written the name of a handler that we made up, which we're calling <code>whisper_in_the_console</code> but we haven't declared it anywhere. Rust doesn't know what this means. To fix this we'll declare this variable and assign a value to it which is a closure, a function which can run, but which is stored in a variable.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[component]  
fn LuckyNumber(cx: Scope, the_lucky_number: i32) -&gt; Element {
	let whisper_in_the_console = |_|{  
	    web_sys::console::log_1(&amp;42.into());
	};  
	view!{  
	    cx,  
	    &lt;div&gt;  
	        &lt;p&gt;&quot;Today's lucky number is &quot; {the_lucky_number}&lt;/p&gt;  
	        &lt;button on:click=whisper_in_the_console &gt;
		        &quot;Your Secret Lucky Number&quot;
			&lt;/button&gt;  
	    &lt;/div&gt;  
	}
}
<span class="boring">}</span></code></pre></pre>
<p>Let's break down what this assignment means. We'll be less verbose in later chapters, but it's important to start thinking in terms of what we're communicating to the compiler. This will help you become a native speaker of the Rust language. :)</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let whisper_in_the_console = |_|{  
    web_sys::console::log_1(&amp;42.into());
};  
<span class="boring">}</span></code></pre></pre>
<p>And like that, now when we click on the button we get the number 42 printed out in the console!</p>
<blockquote>
<p>SUPER IMPORTANT: You do not need to understand the body of this closure to continue. There will be numerous examples of event handlers in future chapters. I am specifically using this example so that you can log something to the browser's console. Further reading will expose you to some advanced concepts about the rust programming language.</p>
</blockquote>
<h4 id="event-handler-closure-signature"><a class="header" href="#event-handler-closure-signature">Event handler closure signature</a></h4>
<p>First let's look at how we even declared the closure and assigned it as a value to a variable. In case you're curious, this is what it means when functions are first class citizens. You might hear programmers mention this idea. It just means that a function can be assigned as a value and passed around.</p>
<p>Here's what the first line says:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>	let whisper_in_the_console = |_|{ 
		// this is a comment, letting you know that we removed the
		// event handler's body which we'll step through soon
	};
<span class="boring">}</span></code></pre></pre>
<p><code>let</code> (let it be/declare) that <code>whisper_in_the_console</code> is equal to (there for, it is) a closure which accepts an argument which is never used (marked by the <code>_</code> /underscore character ).</p>
<p>Event handlers must be a function with a single parameter for the event that triggered the handler (the respondant). In our case we're not using that argument, so it's convention to write an underscore in its place instead of giving it a name.</p>
<h4 id="event-handler-body"><a class="header" href="#event-handler-body">Event handler body</a></h4>
<p>There is a lot to unpack in this single line of code:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>web_sys::console::log_1(&amp;42.into());
<span class="boring">}</span></code></pre></pre>
<p>The first bit is the crate's, <code>web_sys</code>. Crates are what Rust nomenclature uses when refering to packages or libraries. <code>web_sys</code> can be used in this scope because it was made public and brought into the leptos crate's scope. By writing <code>use leptos::*;</code> at the top of our main.rs file we're bringing in everything that is public in Leptos'.</p>
<blockquote>
<p>You may ask &quot;How did you know to use web_sys?&quot; To be honest, it's a matter of asking around, seeing other examples and discovering useful crates. Some are very popular like web sys and you will use them because they're used in the libraries or frameworks that you're consuming. Developers don't magically know about all of these tools. It takes a lot of exposure to the community to develop this awareness and understanding. Stay cool about it. The knowledge will come with time. For now, trust the process.</p>
</blockquote>
<p>When we write <code>web_sys::console::log_1</code> we're saying, &quot;Use the log_1&quot; function in the console module, from the web_sys crate. </p>
<p>This is the <code>web_sys</code> crate's equivalent of calling console.log in the JavaScript console. In JavaScript you can include as many arguments as you want when calling the log function. This is what programmers call a &quot;variadic&quot; function. Rust does not allow this. To accommodate multiple arguments, console has functions for log, log_1, log_2, log_3 and so on. We have to specify the number of arguments in rust, which is sort of awkwardly, but clearly, done with the suffixed number.</p>
<p>The log function in Rust accept a reference to JsValue data type. Recall that we talked about how types are constraints for possible values. JsValue exists because JavaScript doesn't have any type system what so ever. Rust developers needed to make a type that could interoperate safely with JavaScripts untyped world. </p>
<p>To convert our number (an i32 litera) to a JsValue type we call the <code>into()</code> method on it, which will convert it ot the required type of the log_1 signature which happens to be a JsValue. The log method also requires that we do not pass the actual owned value. It is expecting a reference to data. We can add an ampersand to specify that this is a reference.
And like that we get...</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>web_sys::console::log_1(&amp;42.into());
<span class="boring">}</span></code></pre></pre>
<p>Call web_sys's console module's log 1 function which we'll pass a single argument to using the number 42 which we'll convert to the accepted/required type and pass it as a reference.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="leptos_component_dynamic_content_separation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="leptos_component_update_from_event.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="leptos_component_dynamic_content_separation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="leptos_component_update_from_event.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
