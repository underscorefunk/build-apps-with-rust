<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Scope and Runtime - Building Apps with Rust</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Preamble</li><li class="chapter-item expanded "><a href="../read_me_first.html"><strong aria-hidden="true">1.</strong> Notice to Reader</a></li><li class="chapter-item expanded "><a href="../preface.html"><strong aria-hidden="true">2.</strong> Preface</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Acknowledgements</div></li><li class="chapter-item expanded "><a href="../about.html"><strong aria-hidden="true">4.</strong> About this Book</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> About the Author</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> If you get stuck or lose steam</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Introductions</li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Programming</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> What it is</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.2.</strong> Why it's worth it</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.3.</strong> Why it's hard</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.4.</strong> Programmer Thinking</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Languages</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> Meaning and Interpretation</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Architectures</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">9.1.</strong> What is architecture</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.2.</strong> How your computer works</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.3.</strong> How the web works</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.4.</strong> The frontend-backend divide</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.5.</strong> General application architecture</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.6.</strong> Trade-offs between WASM and JavaScript</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> Tools and Languages</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">10.1.</strong> Web browsers</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.2.</strong> HTML</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.3.</strong> Bash and the terminal</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.4.</strong> Rust</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.5.</strong> Trunk</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.6.</strong> Cargo Leptos</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> Other Resources</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../intro/other_resources/rust.html"><strong aria-hidden="true">11.1.</strong> Rust</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Getting Started with Rust and Leptos</li><li class="chapter-item expanded "><a href="../getting_started/setup.html"><strong aria-hidden="true">12.</strong> Setup</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.</strong> Architecture</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">13.1.</strong> Leptos Components - #[component]</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.2.</strong> Signals (reactive values) - create_signal</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.3.</strong> Effects (side effects) - create_effect</div></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Generting UI</li><li class="chapter-item expanded "><a href="../client/summary.html"><strong aria-hidden="true">14.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> Setup</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">15.1.</strong> Trunk</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">16.</strong> Introspection and Debugging</div></li><li class="chapter-item expanded "><a href="../getting_started/html_intro.html"><strong aria-hidden="true">17.</strong> HTML</a></li><li class="chapter-item expanded "><a href="../getting_started/view_macro_html.html"><strong aria-hidden="true">18.</strong> The view! macro</a></li><li class="chapter-item expanded "><a href="../ui/leptos_component_intro.html"><strong aria-hidden="true">19.</strong> Leptos Components</a></li><li class="chapter-item expanded "><a href="../ui/view_macro_variables.html"><strong aria-hidden="true">20.</strong> Variables and the view! macro</a></li><li class="chapter-item expanded "><a href="../ui/leptos_component_properties.html"><strong aria-hidden="true">21.</strong> Component properties</a></li><li class="chapter-item expanded "><a href="../ui/leptos_component_dynamic_content_separation.html"><strong aria-hidden="true">22.</strong> Component dynamic content separation</a></li><li class="chapter-item expanded "><a href="../ui/loops_and_the_for_view_macro_tag.html"><strong aria-hidden="true">23.</strong> Loops and the &lt;For /&gt; view! macro tag</a></li><li class="chapter-item expanded "><a href="../ui/conditional_display_and_the_show_macro.html"><strong aria-hidden="true">24.</strong> Conditional display and the &lt;Show&gt; view! macro tag</a></li><li class="chapter-item expanded "><a href="../ui/tables_and_data_sets.html"><strong aria-hidden="true">25.</strong> Tables and data sets</a></li><li class="chapter-item expanded "><a href="../ui/reserved_tags.html"><strong aria-hidden="true">26.</strong> Reserved Tags</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Client Side</li><li class="chapter-item expanded "><a href="../client/summary.html"><strong aria-hidden="true">27.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">28.</strong> Setup</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">28.1.</strong> Trunk</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">29.</strong> Introspection and Debugging</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">30.</strong> Responding to Events</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../client/responding/leptos_component_logging_events.html"><strong aria-hidden="true">30.1.</strong> Witnessing events</a></li><li class="chapter-item expanded "><a href="../client/responding/leptos_component_update_from_event.html"><strong aria-hidden="true">30.2.</strong> Reacting to events with event handlers</a></li><li class="chapter-item expanded "><a href="../client/responding/event_handlers_as_props.html"><strong aria-hidden="true">30.3.</strong> Event handers as props</a></li><li class="chapter-item expanded "><a href="../client/responding/event_bubbling_and_signal_generics.html"><strong aria-hidden="true">30.4.</strong> Event Bubbling and Signal Generics</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">30.5.</strong> Preventing bubbling and default event behaviours </div></li><li class="chapter-item expanded "><a href="../client/responding/custom_events.html"><strong aria-hidden="true">30.6.</strong> Custom Events</a></li><li class="chapter-item expanded "><a href="../client/responding/custom_event_data.html"><strong aria-hidden="true">30.7.</strong> Custom Event Data</a></li><li class="chapter-item expanded "><a href="../client/responding/custom_event_module.html"><strong aria-hidden="true">30.8.</strong> Custom Event Module</a></li><li class="chapter-item expanded "><a href="../client/responding/custom_event_module_with_data.html"><strong aria-hidden="true">30.9.</strong> Custom Event Module with Data</a></li><li class="chapter-item expanded "><a href="../client/responding/custom_event_data_with_signals_and_effects.html"><strong aria-hidden="true">30.10.</strong> Custom Event Data with Signals and Effects</a></li><li class="chapter-item expanded "><a href="../client/responding/custom_event_data_with_signals_and_effects_part2.html"><strong aria-hidden="true">30.11.</strong> Custom Event Data with Signals and Effects - Part 2</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">31.</strong> Sending Data</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../client/responding/forms.html"><strong aria-hidden="true">31.1.</strong> Forms</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">31.2.</strong> Acton Forms</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">32.</strong> Sending and Receiving Data</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">32.1.</strong> Fetch</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">32.2.</strong> Web Socket</div></li></ol></li><li class="chapter-item expanded "><a href="../client/store_data/summary.html"><strong aria-hidden="true">33.</strong> Saving/Persisting Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../client/store_data/web_storage.html"><strong aria-hidden="true">33.1.</strong> Local Storage</a></li><li class="chapter-item expanded "><a href="../client/store_data/cookies.html"><strong aria-hidden="true">33.2.</strong> Cookies</a></li><li class="chapter-item expanded "><a href="../client/store_data/indexeddb.html"><strong aria-hidden="true">33.3.</strong> IndexedDB</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Server Side</li><li class="chapter-item expanded "><a href="../server/summary.html"><strong aria-hidden="true">34.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">35.</strong> Setup</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/cargo_leptos/summary.html"><strong aria-hidden="true">35.1.</strong> Cargo Leptos</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/cargo_leptos/setup.html"><strong aria-hidden="true">35.1.1.</strong> Setup</a></li><li class="chapter-item expanded "><a href="../server/cargo_leptos/file_structure.html"><strong aria-hidden="true">35.1.2.</strong> File Structure</a></li><li class="chapter-item expanded "><a href="../server/cargo_leptos/config.html"><strong aria-hidden="true">35.1.3.</strong> Config</a></li><li class="chapter-item expanded "><a href="../server/cargo_leptos/overview_main.html"><strong aria-hidden="true">35.1.4.</strong> Server Initialization and Main.rs</a></li><li class="chapter-item expanded "><a href="../server/cargo_leptos/overview_app.html"><strong aria-hidden="true">35.1.5.</strong> Leptos app main component and app.rs</a></li><li class="chapter-item expanded "><a href="../server/cargo_leptos/leptos_meta.html"><strong aria-hidden="true">35.1.6.</strong> Leptos_meta</a></li><li class="chapter-item expanded "><a href="../server/cargo_leptos/leptos_router.html"><strong aria-hidden="true">35.1.7.</strong> Leptos_router</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">36.</strong> Introspection and Debugging</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.</strong> Responding to Requests</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/responding/get_method_forms.html"><strong aria-hidden="true">37.1.</strong> Get Method Forms</a></li><li class="chapter-item expanded "><a href="../server/responding/post_method_forms.html"><strong aria-hidden="true">37.2.</strong> Post Method Forms</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.3.</strong> Accessing Request Data</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.4.</strong> Responding Parts</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">37.4.1.</strong> Headers</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.4.2.</strong> Cookies</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.4.3.</strong> Body</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.5.</strong> HTML Requests - Routes</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.6.</strong> Data Requests - Server Functions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">37.7.</strong> Behaviour Request - Server Actions</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">38.</strong> Client Server Communication</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/server_client_communication/server_functions.html"><strong aria-hidden="true">38.1.</strong> Server Functions</a></li><li class="chapter-item expanded "><a href="../server/server_client_communication/transition.html"><strong aria-hidden="true">38.2.</strong> &lt;Transition&gt;</a></li><li class="chapter-item expanded "><a href="../server/server_client_communication/action_form.html"><strong aria-hidden="true">38.3.</strong> &lt;ActionForm&gt;</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">38.4.</strong> Web Sockets</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">39.</strong> Saving/Persisting Data</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Architecture</li><li class="chapter-item expanded "><a href="../architecture/scope_and_runtime.html" class="active"><strong aria-hidden="true">40.</strong> Scope and Runtime</a></li><li class="chapter-item expanded "><a href="../architecture/passing_data_around.html"><strong aria-hidden="true">41.</strong> Passing data around</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Deployment</li><li class="chapter-item expanded "><div><strong aria-hidden="true">42.</strong> Render.com</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">43.</strong> Fly.io</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">44.</strong> Cloudflare Workers</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Desktop Applications</li><li class="chapter-item expanded "><div><strong aria-hidden="true">45.</strong> Tauri</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">46.</strong> TUI</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Tutorial Projects</li><li class="chapter-item expanded "><div><strong aria-hidden="true">47.</strong> Blog</div></li><li class="chapter-item expanded "><a href="../tutorial_projects/initiative_tracker/summary.html"><strong aria-hidden="true">48.</strong> RPG Initiative Tracker</a></li><li class="chapter-item expanded "><a href="../tutorial_projects/chat/summary.html"><strong aria-hidden="true">49.</strong> Chat</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Quick Reference</li><li class="chapter-item expanded "><a href="../quick_reference/rust/structuring_applications.html"><strong aria-hidden="true">50.</strong> Structuring Applications</a></li><li class="chapter-item expanded "><a href="../quick_reference/rust/documenting_applications.html"><strong aria-hidden="true">51.</strong> Documenting Applications</a></li><li class="chapter-item expanded "><a href="../quick_reference/rust/testing_applications.html"><strong aria-hidden="true">52.</strong> Testing Applications</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Recipes</li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Appendix</li><li class="chapter-item expanded "><div><strong aria-hidden="true">53.</strong> Common Application Behaviours</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">53.1.</strong> Form Validation</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">54.</strong> Common Design Patterns</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">54.1.</strong> Event Sourcing</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">55.</strong> Common Problems and Concerns</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">55.1.</strong> Quality</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">55.1.1.</strong> UI Response Time</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">55.1.2.</strong> Bundle Size</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">55.1.3.</strong> Partial Hydration</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">55.2.</strong> Consistency</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">55.2.1.</strong> Offline Support and Data Sync</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">55.2.2.</strong> Observability and Logging</div></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Building Apps with Rust</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="scope-and-runtime"><a class="header" href="#scope-and-runtime">Scope and Runtime</a></h1>
<h2 id="intro-to-scopes"><a class="header" href="#intro-to-scopes">Intro to scopes</a></h2>
<p>When we think about scope we can think about bound and context. A chef would consider their kitchen to be a scope. It provide the context—ingredients, tools/implements, etc—for them to do their work. If we look around we can make note of our own contexts and scope a we observe our surroundings. </p>
<p>This same idea of scope exists in programming. If we look at a function definition we can see a sort of doorway or entry point through a functions properties that allow us to pass arguments into the function body. Once we're in the function body we're in a scope. We're bounded by curly braces. Rust affords the ability for us to access some ideas from outside the scope but for the most part, what we do is contained within those bounds.</p>
<p>We would say that Rust is lexically scoped. This means that variables initialized within a scope—contained within curly braces <code>{...}</code>—exist within the scope they were created. We know from previous articles that Rust's solution to not having a garbage collector is to clean up anything within a scope once we exist it. The only way we can save information is to return it out of the scope with the <code>return</code> keyword, or having it as the last expression in our scope.</p>
<p>You'll start to see small scopes all over the place. We use them for match arms, for if statements, for iterator bodies, etc.</p>
<h2 id="the-problem"><a class="header" href="#the-problem">The Problem</a></h2>
<p>As you can imagine, creating things within a scope only to have them cleaned up later poses a bit of a problem for a web framework. In this article we'll cover a few core aspects of Leptos that answer the following questions:</p>
<p>1 - How can we create assignments (signals, contexts, etc) that can outline a component's function scope?</p>
<p>2 - How can we clean up assignments (memory) if it's decoupled from a component's function scope?</p>
<p>By answering these question you'll have a clear picture of how data is stored in Leptos' reactive system, what <code>Scope</code> is, and why it's a required argument to so many functions.</p>
<h2 id="the-solution"><a class="header" href="#the-solution">The solution</a></h2>
<p>The two solutions are:</p>
<p><em>1 - How can we create assignments (signals, contexts, etc) that can outline a component's function scope?</em> We store the data outside of the component.</p>
<p><em>2 - How can we clean up assignments (memory) if it's decoupled from a component's function scope?</em> We create a relationship between the component and it's long lived data store so that if a component gets cleaned up we can find the associated data and clean it up as well.</p>
<h2 id="runtime"><a class="header" href="#runtime"><code>Runtime</code></a></h2>
<p>At the core of each Leptos application is a runtime. A new runtime is created in the following cases:</p>
<p>1 - A client side application starts
2 - A web request is being handled
3 - A server function is being called</p>
<p>The runtime is a singleton (there is a single instance of it) that holds the current state of the reactive system. In it you will find (this is not exhaustive):</p>
<p><strong>Reactive components that you created inside components:</strong></p>
<ul>
<li>A list of <code>signals</code> and <code>signal_subscribers</code></li>
<li>A list of <code>effects</code> and <code>effect_sources</code></li>
<li>A list of <code>resources</code></li>
<li>A list of <code>scope_contexts</code></li>
</ul>
<p><strong>Scopes created from instantiated Leptos components:</strong></p>
<ul>
<li>A list of the <code>Scope</code>s with references to reactive components created within their context</li>
<li>A list of each <code>Scope</code>s parents`</li>
<li>A list of each <code>Scope</code>s children`
<em>By capturing the parents and children Leptos is able to create a graph.</em></li>
</ul>
<h2 id="scope"><a class="header" href="#scope">Scope</a></h2>
<p>When a component is created, a new <code>Scope</code> is created. This scope is actually created in the runtime and injected as the component's context <code>cx</code>. In conversational terms we say, &quot;Hey reactive system/runtime. I've got a new component that I'm setting up. Can you give me a new scope?&quot; It says, &quot;Sure, I've got this thing called <code>SlotMap</code> that I'm going to use for this. It says the next number is 42. That's going to be your scope number.&quot; We actually get a runtime id along with the scope id. The runtime id is important for the server side handling because it helps us refer to the runtime handling our request instead of a neighbours. This happens without developers knowing but it helps us to understand what's going on. It also explains why we can copy scopes so easily. Scopes only contain two number which implement the <code>Copy</code> trait.</p>
<p>It maybe seem a little strange at first. I like to think of the <code>Scope</code> used in components as an index into a graph that mirrors my ui, only in the runtime this graph contains my reactive data. </p>
<h2 id="scope-and-runtime-in-use-with-create_signal"><a class="header" href="#scope-and-runtime-in-use-with-create_signal">Scope and runtime in use with <code>create_signal</code></a></h2>
<p>Let's take a look at how <code>create_signal</code> uses scopes, which use our active runtime, to store a value that can outlive the lexical scope.</p>
<p>When we say <code>create_signal(cx, some_value)</code>,  in conversational terms we're saying, &quot;I want to create a signal for some_value. My context <code>cx</code> is a <code>Scope</code> that shows I'm using <code>runtime 1</code> and the id of this scope is <code>3</code>.&quot;  Leptos says, &quot;Cool cool. Ok, I'll make this signal and store it in my big list of signals. It's at id 42. Oh, I see you made this request in scope 3. I'm going to make a note here in my list of scopes that scope three has a signal with the id 42. That way if the scope gets cleaned up, I can clear the signal. Oh, and  here are the read and write handers you asked for (the return value of create_signal).&quot;</p>
<p>This is the real key. When we create something in a scope, it actually gets added to the runtime and we annotate the scope with an id for reference. When the scope is cleaned up, we can clear all of the assets in its reference list. </p>
<p>Here's a more visual way of looking at it:</p>
<h4 id="we-setup-the-request-t-create-a-signal-with-a-scope"><a class="header" href="#we-setup-the-request-t-create-a-signal-with-a-scope">We setup the request t create a signal with a scope</a></h4>
<pre><code>MyComponent is called as Leptos renders a view!

Inside MyComponent(cx:Scope)
	// Leptos calls this function and provides a new scope as
	// the value of cx = (we'll say runtime: 1, id: 3)
	-&gt; create_signal( cx, false ) 
</code></pre>
<p>For reference, a Scope is:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct Scope {  
    pub runtime: RuntimeId,  
    pub id: ScopeId,  
}
<span class="boring">}</span></code></pre></pre>
<h4 id="create_signal-does-its-work"><a class="header" href="#create_signal-does-its-work">create_signal does its work</a></h4>
<pre><code>I've got a Scope{runtime:1, id:3}
I'll request a signal from runtime
</code></pre>
<h4 id="runtime-does-its-work"><a class="header" href="#runtime-does-its-work">runtime does its work</a></h4>
<pre><code>I've got a request to make a signal
I'll create a new signal and store it in my `signals`
</code></pre>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub(crate) struct Runtime {  
    // ...
    // A fancy array that when you put something in, gives you the index out
	pub signals: RefCell&lt;SlotMap&lt;SignalId, Rc&lt;RefCell&lt;dyn Any&gt;&gt;&gt;&gt;
	// ...
}
<span class="boring">}</span></code></pre></pre>
<pre><code>I now have a location where I put the actual signal. It happens to be 42
I'll now upate my ledger of &quot;stuff associated with scopes&quot;.
I know the scope id was 3, so I'll update the item with id 3 from scopes and push in a reference to this new signal so that it can be cleaned up when necessary.
</code></pre>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// leptos-reactive/runtime.rs

#[derive(Default)]  
pub(crate) struct Runtime {  
    // ...
    pub scopes: RefCell&lt;SlotMap&lt;ScopeId, RefCell&lt;Vec&lt;ScopeProperty&gt;&gt;&gt;&gt;,
    // ...
}
<span class="boring">}</span></code></pre></pre>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub(crate) enum ScopeProperty {  
    Signal(SignalId),  
    Effect(EffectId),  
    Resource(ResourceId),  
}
<span class="boring">}</span></code></pre></pre>
<h2 id="wrapping-up"><a class="header" href="#wrapping-up">Wrapping up</a></h2>
<p>And that's it ^.^</p>
<p>To summarize:</p>
<ul>
<li>A runtime stores all of the actual reactive data. </li>
<li>Scope are numerical references to key associated reactive data in a runtime</li>
<li>When a scope is cleaned up, it's associated reactive data is cleaned up</li>
<li>When a component is cleaned up, its scope are cleaned up</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../server/server_client_communication/action_form.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../architecture/passing_data_around.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../server/server_client_communication/action_form.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../architecture/passing_data_around.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
